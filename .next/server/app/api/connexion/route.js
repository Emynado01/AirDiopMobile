"use strict";(()=>{var e={};e.id=130,e.ids=[130],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},6162:e=>{e.exports=require("stream")},1764:e=>{e.exports=require("util")},6098:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>S,patchFetch:()=>v,requestAsyncStorage:()=>f,routeModule:()=>x,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var i={};t.r(i),t.d(i,{POST:()=>m});var n=t(9303),s=t(8716),o=t(670),a=t(3524),u=t(8691),p=t(1482),c=t.n(p);let d=new a.PrismaClient,l=process.env.JWT_SECRET||"supersecret!";async function m(e){let{email:r,password:t}=await e.json(),i=await d.user.findUnique({where:{email:r}});if(!i)return new Response(JSON.stringify({error:"Utilisateur non trouv\xe9"}),{status:404});if(!await u.ZP.compare(t,i.password))return new Response(JSON.stringify({error:"Mot de passe incorrect"}),{status:401});let n=c().sign({id:i.id,email:i.email,isAdmin:i.isAdmin},l,{expiresIn:"7d"}),s=new Response(JSON.stringify({success:!0,message:"Connexion r\xe9ussie",user:{id:i.id,email:i.email}}),{status:200});return s.headers.append("Set-Cookie",`auth=${n}; HttpOnly; Path=/; Max-Age=604800; SameSite=Strict; Secure;`),s}let x=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/connexion/route",pathname:"/api/connexion",filename:"route",bundlePath:"app/api/connexion/route"},resolvedPagePath:"C:\\Users\\emyna\\Documents\\Ecole\\React\\ProjetINT\\AirDiopMobile-main03\\AirDiopMobile-main\\src\\app\\api\\connexion\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:f,staticGenerationAsyncStorage:g,serverHooks:h}=x,S="/api/connexion/route";function v(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}},9303:(e,r,t)=>{e.exports=t(517)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[948,482,691],()=>t(6098));module.exports=i})();