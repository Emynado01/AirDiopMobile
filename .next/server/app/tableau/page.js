(()=>{var e={};e.id=860,e.ids=[860],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7931:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>d}),s(6417),s(2029),s(5866);var a=s(3191),r=s(8716),l=s(7922),i=s.n(l),n=s(5231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(t,o);let d=["",{children:["tableau",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,6417)),"C:\\Users\\emyna\\Documents\\Ecole\\React\\ProjetINT\\AirDiopMobile-main03\\AirDiopMobile-main\\src\\app\\tableau\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,2029)),"C:\\Users\\emyna\\Documents\\Ecole\\React\\ProjetINT\\AirDiopMobile-main03\\AirDiopMobile-main\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\emyna\\Documents\\Ecole\\React\\ProjetINT\\AirDiopMobile-main03\\AirDiopMobile-main\\src\\app\\tableau\\page.tsx"],m="/tableau/page",x={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/tableau/page",pathname:"/tableau",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},8441:(e,t,s)=>{Promise.resolve().then(s.bind(s,2493))},7358:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(2881).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},1291:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(2881).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},8998:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(2881).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},2493:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var a=s(326),r=s(7577),l=s(6641),i=s(7358),n=s(7636);let o=({reservations:e})=>{let t=e.length,s=e.filter(e=>"active"===e.status).length,r=e.filter(e=>"cancelled"===e.status).length,o=new Set(e.map(e=>e.arrival)).size,d=[{title:"R\xe9servations totales",value:t,icon:l.Z,bgColor:"bg-sky-50",textColor:"text-sky-600"},{title:"R\xe9servations actives",value:s,icon:i.Z,bgColor:"bg-green-50",textColor:"text-green-600"},{title:"R\xe9servations annul\xe9es",value:r,icon:i.Z,bgColor:"bg-red-50",textColor:"text-red-600"},{title:"Destinations",value:o,icon:n.Z,bgColor:"bg-indigo-50",textColor:"text-indigo-600"}];return(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white dark:drop-shadow-lg mb-6",children:"Tableau de bord"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:d.map((e,t)=>a.jsx("div",{className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow duration-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:e.title}),a.jsx("p",{className:"text-3xl font-bold text-gray-900",children:e.value})]}),a.jsx("div",{className:`w-12 h-12 ${e.bgColor} rounded-lg flex items-center justify-center`,children:a.jsx(e.icon,{className:`w-6 h-6 ${e.textColor}`})})]})},t))}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activit\xe9 des r\xe9servations"}),a.jsx("div",{className:"grid grid-cols-12 gap-2 h-32 items-end",children:Array.from({length:12},(e,t)=>{let s=t===new Date().getMonth();return a.jsx("div",{className:`rounded-t-sm transition-all duration-300 hover:opacity-80 ${s?"bg-sky-500":"bg-gray-300"}`,style:{height:`${100*Math.random()+20}%`},title:`${["Jan","F\xe9v","Mar","Avr","Mai","Jun","Jul","Ao\xfb","Sep","Oct","Nov","D\xe9c"][t]}`},t)})}),a.jsx("div",{className:"grid grid-cols-12 gap-2 mt-2",children:["J","F","M","A","M","J","J","A","S","O","N","D"].map((e,t)=>a.jsx("div",{className:"text-xs text-gray-500 text-center",children:e},t))})]})]})};var d=s(1291),c=s(8998);let m=({reservations:e,showAll:t=!1,onViewAll:s,onPay:r,onCancel:i})=>{let o=e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},m=e=>{switch(e){case"active":return"Active";case"cancelled":return"Annul\xe9e";default:return e}},x=e.filter(e=>e.paid).length;return(0,a.jsxs)(a.Fragment,{children:[x>0&&(0,a.jsxs)("div",{className:"flex items-center p-4 bg-green-100 rounded-lg shadow mb-6 max-w-xs ml-auto",children:[a.jsx("span",{className:"w-10 h-10 flex items-center justify-center bg-green-400 rounded-full text-white font-bold mr-3 text-lg",children:x}),a.jsx("span",{className:"text-green-800 font-medium",children:"R\xe9servations pay\xe9es"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:t?"Toutes mes r\xe9servations":"R\xe9servations r\xe9centes"}),!t&&s&&a.jsx("button",{onClick:s,className:"text-sky-500 hover:text-sky-600 font-medium transition-colors",children:"Voir tout"})]}),0===e.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(l.Z,{className:"w-8 h-8 text-gray-400"})}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune r\xe9servation"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Vous n'avez pas encore de r\xe9servations. Commencez par rechercher un vol!"}),(0,a.jsxs)("a",{href:"/",className:"inline-flex items-center space-x-2 px-6 py-3 bg-sky-500 text-white rounded-lg hover:bg-sky-600 transition-colors",children:[a.jsx(l.Z,{className:"w-5 h-5"}),a.jsx("span",{children:"Rechercher un vol"})]})]}):a.jsx("div",{className:"space-y-6",children:e.map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4 mb-4 md:mb-0",children:[a.jsx("div",{className:"w-12 h-12 bg-sky-100 rounded-full flex items-center justify-center",children:a.jsx(l.Z,{className:"w-6 h-6 text-sky-600"})}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900",children:e.airline}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Vol ID: ",e.flightId]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${o(e.status)}`,children:m(e.status)}),"active"===e.status&&(0,a.jsxs)("div",{className:"flex items-center space-x-1 text-orange-600",children:[a.jsx(d.Z,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:"\xc0 venir"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx(n.Z,{className:"w-5 h-5 text-gray-400"}),(0,a.jsxs)("span",{className:"text-gray-700 font-medium",children:["D\xe9part : ",e.departure]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx(n.Z,{className:"w-5 h-5 text-gray-400"}),(0,a.jsxs)("span",{className:"text-gray-700 font-medium",children:["Arriv\xe9e : ",e.arrival]})]})]}),(0,a.jsxs)("div",{className:"flex items-center mt-4 text-sm text-gray-500",children:[a.jsx(c.Z,{className:"w-4 h-4 mr-2"}),"R\xe9serv\xe9 le : ",new Date(e.bookingDate).toLocaleString("fr-FR")]}),(0,a.jsxs)("div",{className:"flex space-x-2 mt-2",children:[!e.paid&&"cancelled"!==e.status&&r&&a.jsx("button",{onClick:()=>r(e.id),className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg text-sm transition-colors",children:"Payer"}),"cancelled"!==e.status&&i&&a.jsx("button",{onClick:()=>i(e.id),className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm transition-colors",children:"Annuler"}),e.paid&&a.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium ml-2",children:"Pay\xe9e"})]})]},e.id))})]})]})};function x(){let[e,t]=(0,r.useState)(null);if(!e)return null;let s=`https://ui-avatars.com/api/?name=${encodeURIComponent(((e.name||"")+" "+(e.lastname||"")).trim()||e.email)}&background=0D8ABC&color=fff&size=128`;return(0,a.jsxs)("div",{className:"flex items-center p-4 bg-white rounded-lg shadow mb-6 max-w-xs ml-auto",children:[a.jsx("img",{src:s,alt:"Avatar",className:"w-14 h-14 rounded-full object-cover border-2 border-sky-500 mr-3"}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-semibold text-gray-900",children:(e.name||"")+" "+(e.lastname||"")}),a.jsx("div",{className:"text-sm text-gray-500",children:e.email})]})]})}let u=({onClose:e,onSubmit:t,userEmail:s})=>{let[l,i]=(0,r.useState)(""),[n,o]=(0,r.useState)(""),[d,c]=(0,r.useState)("");return a.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 w-full max-w-md",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Informations de paiement"}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t({card:l,expiry:n,cvc:d})},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-gray-700",children:"Num\xe9ro de carte"}),a.jsx("input",{className:"w-full border px-3 py-2 rounded",value:l,onChange:e=>i(e.target.value),required:!0,maxLength:16,placeholder:"1234 5678 9012 3456"})]}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-gray-700",children:"Expiration"}),a.jsx("input",{className:"w-full border px-3 py-2 rounded",value:n,onChange:e=>o(e.target.value),required:!0,placeholder:"MM/AA"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-gray-700",children:"CVC"}),a.jsx("input",{className:"w-full border px-3 py-2 rounded",value:d,onChange:e=>c(e.target.value),required:!0,maxLength:4,placeholder:"123"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[a.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400",children:"Annuler"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-sky-500 text-white rounded hover:bg-sky-600",children:"Valider le paiement"})]})]})]})})},h={_origin:"https://api.emailjs.com"},p=(e,t,s)=>{if(!e)throw"The user ID is required. Visit https://dashboard.emailjs.com/admin/integration";if(!t)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!s)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};class g{constructor(e){this.status=e.status,this.text=e.responseText}}let v=(e,t,s={})=>new Promise((a,r)=>{let l=new XMLHttpRequest;l.addEventListener("load",({target:e})=>{let t=new g(e);200===t.status||"OK"===t.text?a(t):r(t)}),l.addEventListener("error",({target:e})=>{r(new g(e))}),l.open("POST",h._origin+e,!0),Object.keys(s).forEach(e=>{l.setRequestHeader(e,s[e])}),l.send(t)}),b={send:(e,t,s,a)=>{let r=a||h._userID;return p(r,e,t),v("/api/v1.0/email/send",JSON.stringify({lib_version:"3.2.0",user_id:r,service_id:e,template_id:t,template_params:s}),{"Content-type":"application/json"})}};function j(){let[e,t]=(0,r.useState)([]),[s,l]=(0,r.useState)(!0),[i,n]=(0,r.useState)(null),[d,c]=(0,r.useState)(null),[h,p]=(0,r.useState)(null),[g,v]=(0,r.useState)(!1),[j,y]=(0,r.useState)(null),f=async e=>{await fetch("/api/reservation/cancel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}),window.location.reload()},N=async e=>{j&&((await fetch("/api/reservation/pay",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:j})}),console.log("userEmail pour EmailJS:",i),console.log("userName pour EmailJS:",d),i&&d)?(console.log({name:d,email:i,subject:"Confirmation de paiement"}),await b.send("service_gzqnlc6","template_lgaaqh4",{name:d,subject:"Confirmation de paiement",email:i},"xgOGP15uUurppk0ph").then(()=>alert("Email envoy\xe9 ! V\xe9rifiez votre bo\xeete mail.")).catch(e=>{console.error("Erreur EmailJS:",e),alert("Erreur lors de l'envoi de l'email : "+(e?.text||e?.message||e))})):alert("Erreur : nom ou email manquant pour l'envoi de l'email de confirmation."),v(!1),y(null),window.location.reload())};return s?a.jsx("div",{className:"text-center py-10",children:"Chargement..."}):h?a.jsx("div",{className:"text-center py-10 text-red-500",children:h}):(0,a.jsxs)("div",{className:"max-w-5xl mx-auto px-4 py-8",children:[a.jsx(x,{}),a.jsx(o,{reservations:e}),a.jsx("div",{className:"mt-8",children:a.jsx(m,{reservations:e,showAll:!0,onPay:e=>{y(e),v(!0)},onCancel:f})}),g&&a.jsx(u,{onClose:()=>v(!1),onSubmit:N,userEmail:i||void 0})]})}var y=s(8795);function f(){return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors",children:[a.jsx(y.Header,{}),a.jsx("main",{children:a.jsx(j,{})})]})}},6417:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(8570).createProxy)(String.raw`C:\Users\emyna\Documents\Ecole\React\ProjetINT\AirDiopMobile-main03\AirDiopMobile-main\src\app\tableau\page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[948,994,381],()=>s(7931));module.exports=a})();